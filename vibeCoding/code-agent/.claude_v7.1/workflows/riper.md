# RIPER-10 执行循环

> **渐进式开发**: 在着手任何设计或编码工作前，必须完成前期调研并厘清所有疑点

## 完整流程图

```
┌─────────────────────────────────────────────────────────┐
│                    RIPER-10 Flow                        │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────┐    ┌─────┐    ┌─────┐    ┌─────┐    ┌─────┐   │
│  │ R1  │───▶│  I  │───▶│  P  │───▶│  E  │───▶│ R2  │   │
│  └─────┘    └─────┘    └─────┘    └─────┘    └─────┘   │
│  感知       设计       锁定       执行       闭环       │
│                                                         │
│  memory     thinking   meeting   codex      memory     │
│  sou        meeting             寸止       寸止       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

## R1 - RESEARCH (感知)

**目标**: 理解上下文，厘清疑点

**动作**:
```
1. memory.recall(project_path)     // 加载记忆
2. sou.search("<关键词>")          // 语义搜索
3. 仅读取直接相关文件             // 禁止全量扫描
```

**第一性原理问题**:
- 用户真正需要什么？
- 现有代码是怎样的？
- 有哪些约束？

**产出**: 任务上下文 + 疑点清单

---

## I - INNOVATE (设计) [Path B/C]

**目标**: 第一性原理设计

**参与角色**: AR + LD + SA (via meeting skill)

**动作**:
```
1. 召开技术设计会议
2. 第一性原理分析:
   - 问题本质是什么？
   - 最简数据结构是什么？
3. Linus审查清单
4. 多方案 → 寸止让用户选择
```

**Linus审查**:
- [ ] Data First: 数据结构最简？
- [ ] Naming: 命名准确？
- [ ] Simplicity: 过度设计？
- [ ] Taste: 有好味道？

**产出**: 锁定的Interface/Type定义

---

## P - PLAN (锁定) [Path B/C]

**目标**: 任务分解与确认

**参与角色**: PM + LD (via meeting skill)

**动作**:
```
1. 召开任务规划会议
2. 分解为可执行任务
3. 寸止展示任务清单
4. 等待用户批准
5. 禁止未批准开始编码
```

**任务模板**:
```markdown
| ID | 任务 | 文件范围 | 预估 | 依赖 |
|:---|:---|:---|:---|:---|
| T1 | ... | ... | ... | - |
```

**产出**: 已批准的任务清单

---

## E - EXECUTE (执行)

**目标**: 实现代码

**角色**: LD (via codex skill)

**动作**:
```
1. codex skill 执行任务
2. 执行前自检:
   - TypeScript无any
   - 函数<50行
   - 完整错误处理
3. 自我修复(max 3) → 寸止人工
```

**产出**: 可运行代码

---

## R2 - REVIEW (闭环)

**目标**: 验收与知识沉淀

**动作**:
```
1. 完整性校验:
   - 所有任务完成？
   - 遗留TODO？
2. memory.add 固化重要决策
3. 寸止请求验收
4. 等待用户确认，禁止自行结束
```

**产出**: 验收确认 + 记忆更新
