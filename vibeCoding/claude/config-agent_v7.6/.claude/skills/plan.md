# P - PLAN (生成TODO)

> 加载时机：RIPER 第三阶段 | 角色：PM

---

## 执行步骤

### Step 1: 任务分解
```
原则：
1. MECE（互斥穷尽）- 任务不重叠，总和覆盖全部需求
2. 粒度 < 4小时 - 太大则继续拆分
3. 验收明确 - 每个任务可客观判断"完成"
4. 依赖清晰 - 识别任务间依赖关系
```

### Step 2: 生成 TODO 列表
```markdown
## 📋 TODO

- [ ] T-001: [任务描述]
  - **文件**: [涉及文件]
  - **依赖**: 无
  - **预估**: [时间]
  - **验收**: [验收标准]

- [ ] T-002: [任务描述]
  - **文件**: [涉及文件]
  - **依赖**: T-001
  - **预估**: [时间]
  - **验收**: [验收标准]
```

### Step 3: 更新 kanban.md
```markdown
# 📋 项目看板

## 📊 整体进度
░░░░░░░░░░░░░░░░░░░░ 0% (0/N)

## 📥 TODO (待办)
| ID | 任务 | 预估 | 依赖 |
|:---|:---|:---|:---|
| T-001 | xxx | 30min | - |
| T-002 | xxx | 1h | T-001 |

## 🔄 DOING (进行中)
| ID | 任务 | 开始时间 | 进度 |
|:---|:---|:---|:---|
(空)

## ✅ DONE (已完成)
| ID | 任务 | 用时 | 完成时间 |
|:---|:---|:---|:---|
(空)
```

### Step 4: 更新 active_context.md
```
写入完整 TODO 列表
```

### Step 5: 寸止 [PLAN_READY]
```
调用 cunzhi MCP（或 mcp-feedback）

输出：
- 任务概览（总数、预估时间）
- TODO 列表
- 执行顺序

等待用户：确认 / 修改 / 取消
```

---

## 产出物

- [ ] TODO 列表（active_context.md）
- [ ] kanban.md（TODO栏填充）
- [ ] 依赖关系
- [ ] 用户确认记录

---

## 检查点

- [ ] 每个任务 < 4小时
- [ ] 每个任务有验收标准
- [ ] 依赖关系已排序
- [ ] kanban 三栏完整
- [ ] 已调用寸止等待用户

---

## 完成后

用户确认 → 进入 E 阶段，加载 `skills/execute.md`
