# RIPER-10 执行循环

## 完整流程图

```
┌─────────────────────────────────────────────────────────┐
│                    RIPER-10 Flow                        │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────┐    ┌─────┐    ┌─────┐    ┌─────┐    ┌─────┐   │
│  │ R1  │───▶│  I  │───▶│  P  │───▶│  E  │───▶│ R2  │   │
│  └─────┘    └─────┘    └─────┘    └─────┘    └─────┘   │
│  感知       设计       锁定       执行       闭环       │
│                                                         │
│  memory     thinking   shrimp    codex      memory     │
│  sou                             寸止       寸止       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

## R1 - RESEARCH (感知)

**目标**: 理解上下文和差距

**动作**:
```
1. memory.recall(project_path)     // 加载记忆
2. sou.search("<关键词>")          // 语义搜索
3. 仅读取直接相关文件             // 禁止全量扫描
```

**产出**: 任务上下文 + 差距分析

---

## I - INNOVATE (设计) [Path B/C]

**目标**: 设计技术方案

**动作**:
```
1. promptx.switch("AR")
2. sequential-thinking 深度推演
3. Linus审查清单检查
4. 多方案 → 寸止让用户选择
```

**Linus审查**:
- [ ] Data First: 数据结构最简？
- [ ] Naming: 命名准确？
- [ ] Simplicity: 是否过度设计？
- [ ] Compatibility: 向后兼容？

**产出**: 锁定的Interface/Type定义

---

## P - PLAN (锁定) [Path B/C]

**目标**: 制定执行计划

**动作**:
```
1. shrimp-task-manager 生成WBS
2. 寸止展示数据结构变更
3. 等待用户批准
4. 禁止未批准开始编码
```

**产出**: 已批准的任务清单

---

## E - EXECUTE (执行)

**目标**: 实现代码

**动作**:
```
1. promptx.switch("LD")
2. codex skill 执行
3. 执行前自检:
   - Taste: 逻辑清晰？
   - Security: 输入验证？
   - Standards: 无any，函数<50行
4. 自我修复(max 3) → 寸止人工
```

**产出**: 可运行代码

---

## R2 - REVIEW (闭环)

**目标**: 验收和记忆固化

**动作**:
```
1. 完整性校验:
   - 所有任务完成？
   - 遗留TODO？
2. memory.add 固化重要决策
3. 寸止请求验收
4. 等待用户确认，禁止自行结束
```

**产出**: 验收确认 + 记忆更新
