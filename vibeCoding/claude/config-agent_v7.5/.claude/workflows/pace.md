# P.A.C.E. Complexity Router (v7.5 详细版)

> **核心原则**: 所有路径都必须生成TODO、更新kanban、核对、寸止确认
> **不是对话**: 这是工作流驱动的任务执行系统

---

## 🎯 复杂度评估

### 评估维度表

| 维度 | 低(1-3) | 中(4-6) | 高(7-10) | 权重 |
|:---|:---|:---|:---|:---|
| 文件数量 | 1个 | 2-10个 | >10个 | 30% |
| 代码行数 | <30行 | 30-300行 | >300行 | 25% |
| 预估时间 | <30分钟 | 30分-4小时 | >4小时 | 20% |
| 架构影响 | 无 | 局部 | 全局 | 15% |
| 依赖数量 | 0 | 1-3个 | >3个 | 10% |

### 评估流程

```javascript
function evaluateComplexity(task) {
  const scores = {
    files: assessFileCount(task),
    lines: estimateLines(task),
    time: estimateTime(task),
    architecture: assessImpact(task),
    dependencies: countDependencies(task)
  };
  
  const weighted = 
    scores.files * 0.30 +
    scores.lines * 0.25 +
    scores.time * 0.20 +
    scores.architecture * 0.15 +
    scores.dependencies * 0.10;
  
  if (weighted <= 3) return 'PATH_A';
  if (weighted <= 6) return 'PATH_B';
  return 'PATH_C';
}
```

### 评估结果输出

```markdown
## 📊 复杂度评估

| 维度 | 评分 | 说明 |
|:---|:---|:---|
| 文件数量 | 2/10 | 单文件修改 |
| 代码行数 | 3/10 | 约50行 |
| 预估时间 | 3/10 | 约1小时 |
| 架构影响 | 1/10 | 无架构变更 |
| 依赖数量 | 2/10 | 1个依赖 |

**加权分数**: 2.3/10
**选择路径**: Path A (Quick Fix)
```

---

## ⚡ Path A: Quick Fix (快速修复)

### 适用条件
- 单文件修改
- <30行代码变更
- Bug修复、小调整、文档更新
- 无架构影响
- 预估<30分钟

### 完整流程图

```
┌─────────────────────────────────────────────────────────────────────┐
│                       Path A 完整流程                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 1: 创建会话锁 + 生成TODO                                │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ 1.1 创建 session.lock                                       │  │
│  │     {                                                        │  │
│  │       "mode": "workflow",                                    │  │
│  │       "workflow_type": "path_a",                             │  │
│  │       "phase": "EXECUTE"                                     │  │
│  │     }                                                        │  │
│  │                                                              │  │
│  │ 1.2 生成 TODO（即使只有1项）                                 │  │
│  │     - [ ] T-001: [任务描述]                                  │  │
│  │       - 文件: [文件路径]                                     │  │
│  │       - 预估: [时间]                                         │  │
│  │       - 验收: [验收标准]                                     │  │
│  │                                                              │  │
│  │ 1.3 更新 kanban.md                                          │  │
│  │     - T-001 → TODO 栏                                        │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - session.lock                                               │  │
│  │ - active_context.md (含TODO)                                 │  │
│  │ - kanban.md (TODO栏更新)                                     │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                              ↓                                      │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 2: 执行开发                                             │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ 2.1 执行前检查                                               │  │
│  │     - [ ] 加载 code-simplifier                               │  │
│  │     - [ ] 检查 forbidden_action                              │  │
│  │     - [ ] 读取相关代码上下文                                  │  │
│  │                                                              │  │
│  │ 2.2 更新 kanban.md                                          │  │
│  │     - T-001: TODO → DOING                                    │  │
│  │                                                              │  │
│  │ 2.3 执行代码修改                                             │  │
│  │     - 遵循代码简化原则                                       │  │
│  │     - 函数<50行                                              │  │
│  │     - 无any类型                                              │  │
│  │                                                              │  │
│  │ 2.4 验证修改                                                 │  │
│  │     - 运行相关测试                                           │  │
│  │     - 检查无语法错误                                         │  │
│  │     - 确认功能正常                                           │  │
│  │                                                              │  │
│  │ 2.5 更新状态                                                 │  │
│  │     - T-001: DOING → DONE                                    │  │
│  │     - 更新 kanban.md                                         │  │
│  │     - 更新 active_context.md                                 │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - 修改后的代码文件                                           │  │
│  │ - kanban.md (DONE栏更新)                                     │  │
│  │ - active_context.md (任务标记完成)                           │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                              ↓                                      │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 3: TODO核对 + 寸止确认                                  │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ 3.1 生成核对报告                                             │  │
│  │                                                              │  │
│  │     ## ✅ TODO 核对                                          │  │
│  │     - [x] T-001: [描述] ✅                                   │  │
│  │       - 实际文件: [文件] (+X/-Y行)                          │  │
│  │       - 实际用时: [时间]                                    │  │
│  │       - 验证结果: [结果]                                    │  │
│  │                                                              │  │
│  │ 3.2 调用寸止                                                 │  │
│  │                                                              │  │
│  │     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │  │
│  │     📋 [TASK_DONE] 任务完成                                 │  │
│  │                                                              │  │
│  │     ## 核对清单                                              │  │
│  │     - [x] T-001 ✅                                           │  │
│  │                                                              │  │
│  │     ## 变更摘要                                              │  │
│  │     - [文件]: +X/-Y 行                                       │  │
│  │                                                              │  │
│  │     请验收: 通过 / 问题 / 撤销                               │  │
│  │     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │  │
│  │                                                              │  │
│  │ 3.3 等待用户响应                                             │  │
│  │     - 通过 → 删除session.lock，归档                         │  │
│  │     - 问题 → 返回STEP 2修复                                 │  │
│  │     - 撤销 → 回滚修改，删除session.lock                     │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - TODO核对报告                                               │  │
│  │ - 寸止确认记录                                               │  │
│  │ - 归档的工作流状态                                           │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Path A 检查清单

```markdown
## Path A 执行检查清单

### 开始前
- [ ] 创建了 session.lock
- [ ] 生成了 TODO（即使只有1项）
- [ ] 更新了 kanban.md (→TODO栏)
- [ ] 加载了 code-simplifier
- [ ] 检查了 forbidden_action

### 执行中
- [ ] kanban.md 显示 DOING
- [ ] 遵循代码简化原则
- [ ] 验证了修改

### 完成后
- [ ] kanban.md 显示 DONE
- [ ] 生成了 TODO 核对报告
- [ ] 调用了寸止确认
- [ ] 用户确认后删除 session.lock
```

---

## 🤝 Path B: Planned Development (计划开发)

### 适用条件
- 2-10个文件
- 30-300行代码变更
- 新功能开发
- 局部重构
- 预估30分钟-4小时

### 完整流程图

```
┌─────────────────────────────────────────────────────────────────────┐
│                       Path B 完整流程                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 1: 初始化 + 需求分析                                    │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ 1.1 创建 session.lock                                       │  │
│  │     { "mode": "workflow", "phase": "RESEARCH" }             │  │
│  │                                                              │  │
│  │ 1.2 加载 Memory                                             │  │
│  │     - user_preference                                       │  │
│  │     - forbidden_action                                      │  │
│  │     - code_pattern                                          │  │
│  │                                                              │  │
│  │ 1.3 需求理解                                                 │  │
│  │     - 使用 sou 搜索相关代码                                 │  │
│  │     - 读取项目约定 conventions.md                           │  │
│  │     - 识别依赖和约束                                        │  │
│  │                                                              │  │
│  │ 1.4 如有疑问，使用寸止澄清（不是直接问）                    │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - session.lock                                               │  │
│  │ - 需求理解摘要                                               │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                              ↓                                      │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 2: 生成 TODO + 更新 kanban                              │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ 2.1 任务分解                                                 │  │
│  │     - MECE原则（互斥穷尽）                                   │  │
│  │     - 粒度<4小时                                             │  │
│  │     - 明确依赖关系                                           │  │
│  │     - 每个任务有验收标准                                     │  │
│  │                                                              │  │
│  │ 2.2 生成 TODO 列表                                          │  │
│  │                                                              │  │
│  │     ## 📋 TODO                                               │  │
│  │                                                              │  │
│  │     - [ ] T-001: [任务描述]                                  │  │
│  │       - **文件**: [涉及文件]                                 │  │
│  │       - **依赖**: 无                                         │  │
│  │       - **预估**: [时间]                                     │  │
│  │       - **验收**: [验收标准]                                 │  │
│  │       - **Owner**: LD                                        │  │
│  │                                                              │  │
│  │     - [ ] T-002: [任务描述]                                  │  │
│  │       - **文件**: [涉及文件]                                 │  │
│  │       - **依赖**: T-001                                      │  │
│  │       - **预估**: [时间]                                     │  │
│  │       - **验收**: [验收标准]                                 │  │
│  │       - **Owner**: LD                                        │  │
│  │                                                              │  │
│  │ 2.3 更新 kanban.md                                          │  │
│  │                                                              │  │
│  │     ## 📥 TODO (待办)                                        │  │
│  │     | ID | 任务 | 预估 | 依赖 |                             │  │
│  │     | T-001 | xxx | 30min | - |                             │  │
│  │     | T-002 | xxx | 1h | T-001 |                            │  │
│  │                                                              │  │
│  │     ## 🔄 DOING (进行中)                                     │  │
│  │     (空)                                                     │  │
│  │                                                              │  │
│  │     ## ✅ DONE (已完成)                                      │  │
│  │     (空)                                                     │  │
│  │                                                              │  │
│  │ 2.4 更新 active_context.md                                  │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - active_context.md (含完整TODO)                             │  │
│  │ - kanban.md (TODO栏填充)                                     │  │
│  │ - workflow_state.json                                        │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                              ↓                                      │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 3: 寸止 - 计划确认 [PLAN_READY]                         │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │  │
│  │ 📋 [PLAN_READY] 任务计划已生成                              │  │
│  │                                                              │  │
│  │ ## 任务概览                                                  │  │
│  │ - 总任务: X 个                                               │  │
│  │ - 预估时间: X 小时                                           │  │
│  │ - 涉及文件: X 个                                             │  │
│  │                                                              │  │
│  │ ## TODO 列表                                                 │  │
│  │ 1. T-001: xxx (30min)                                       │  │
│  │ 2. T-002: xxx (1h) → 依赖T-001                              │  │
│  │ 3. T-003: xxx (30min) → 依赖T-002                           │  │
│  │                                                              │  │
│  │ ## 执行顺序                                                  │  │
│  │ T-001 → T-002 → T-003                                       │  │
│  │                                                              │  │
│  │ 请确认: 确认 / 修改 / 取消                                   │  │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │  │
│  │                                                              │  │
│  │ 等待用户响应:                                                │  │
│  │ - 确认 → 继续 STEP 4                                        │  │
│  │ - 修改 → 返回 STEP 2 调整                                   │  │
│  │ - 取消 → 删除 session.lock，结束                            │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - 用户确认记录                                               │  │
│  │ - workflow_state.json (checkpoints更新)                      │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                              ↓                                      │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 4: 逐项执行 TODO                                        │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ FOR EACH task IN TODO:                                       │  │
│  │                                                              │  │
│  │   4.1 执行前检查                                             │  │
│  │       - [ ] 检查依赖任务已完成                               │  │
│  │       - [ ] 检查 forbidden_action                            │  │
│  │       - [ ] 加载 code-simplifier                             │  │
│  │       - [ ] 读取相关文档                                     │  │
│  │                                                              │  │
│  │   4.2 更新 kanban.md                                        │  │
│  │       - 任务: TODO → DOING                                   │  │
│  │                                                              │  │
│  │   4.3 执行任务                                               │  │
│  │       - 编写/修改代码                                        │  │
│  │       - 遵循代码简化原则                                     │  │
│  │                                                              │  │
│  │   4.4 验证                                                   │  │
│  │       - 运行相关测试                                         │  │
│  │       - 检查代码质量                                         │  │
│  │       - 验证失败 → 触发错误学习                              │  │
│  │                                                              │  │
│  │   4.5 更新状态                                               │  │
│  │       - 任务: DOING → DONE                                   │  │
│  │       - 更新 kanban.md                                       │  │
│  │       - 更新 active_context.md                               │  │
│  │       - 记录实际用时                                         │  │
│  │                                                              │  │
│  │   4.6 学习沉淀                                               │  │
│  │       - 发现新模式 → memory.add(code_pattern)               │  │
│  │       - 发现错误 → memory.add(lesson_learned)               │  │
│  │                                                              │  │
│  │ END FOR                                                      │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - 修改后的代码文件                                           │  │
│  │ - kanban.md (DONE栏填充)                                     │  │
│  │ - active_context.md (任务标记完成)                           │  │
│  │ - Memory 学习记录                                            │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                              ↓                                      │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │ STEP 5: TODO核对 + 寸止确认 [TASK_DONE]                      │  │
│  ├──────────────────────────────────────────────────────────────┤  │
│  │                                                              │  │
│  │ 5.1 生成核对报告                                             │  │
│  │                                                              │  │
│  │     ## ✅ TODO 核对清单                                      │  │
│  │                                                              │  │
│  │     - [x] T-001: xxx ✅                                      │  │
│  │       - 实际文件: src/xxx.ts (+25/-5)                       │  │
│  │       - 实际用时: 25min (预估: 30min)                       │  │
│  │       - 验证结果: 测试通过                                  │  │
│  │                                                              │  │
│  │     - [x] T-002: xxx ✅                                      │  │
│  │       - 实际文件: src/yyy.ts (+50/-10)                      │  │
│  │       - 实际用时: 55min (预估: 1h)                          │  │
│  │       - 验证结果: 测试通过                                  │  │
│  │                                                              │  │
│  │     ## 📊 执行统计                                           │  │
│  │     - 总任务: 2                                              │  │
│  │     - 已完成: 2 (100%)                                       │  │
│  │     - 总用时: 80min (预估: 90min)                           │  │
│  │                                                              │  │
│  │ 5.2 调用寸止                                                 │  │
│  │                                                              │  │
│  │     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │  │
│  │     📋 [TASK_DONE] 工作流完成                               │  │
│  │                                                              │  │
│  │     [核对报告内容]                                           │  │
│  │                                                              │  │
│  │     ## 📁 变更文件汇总                                       │  │
│  │     - src/xxx.ts (+25/-5)                                   │  │
│  │     - src/yyy.ts (+50/-10)                                  │  │
│  │                                                              │  │
│  │     请验收: 通过 / 问题 / 优化                               │  │
│  │     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │  │
│  │                                                              │  │
│  │ 5.3 等待用户响应                                             │  │
│  │     - 通过 → 删除session.lock，归档                         │  │
│  │     - 问题 → 创建修复任务，返回STEP 4                       │  │
│  │     - 优化 → 创建优化任务，返回STEP 4                       │  │
│  │                                                              │  │
│  │ 【产出物】                                                   │  │
│  │ - TODO核对报告                                               │  │
│  │ - 寸止确认记录                                               │  │
│  │ - 归档的工作流状态                                           │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 🏗️ Path C: System Development (系统开发)

### 适用条件
- >10个文件
- >300行代码变更
- 架构变更
- 从0到1的新系统
- 预估>4小时

### 完整流程图

```
┌─────────────────────────────────────────────────────────────────────┐
│                       Path C 完整流程                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ STEP 1: 深度需求分析 (RESEARCH)                            │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │ - 创建 session.lock                                        │    │
│  │ - 召开需求澄清会（PDM）                                    │    │
│  │ - 第一性原理分析                                           │    │
│  │ - 明确边界和约束                                           │    │
│  │ - 定义验收标准                                             │    │
│  │                                                            │    │
│  │ 【产出物】                                                 │    │
│  │ - 需求分析文档                                             │    │
│  │ - 验收标准清单                                             │    │
│  └────────────────────────────────────────────────────────────┘    │
│                              ↓                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ STEP 2: 架构设计 (INNOVATE)                                │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │ - 加载 thinking skill                                      │    │
│  │ - 逐步思考协议                                             │    │
│  │ - Data First: 先定义数据结构                               │    │
│  │ - 生成2-3个方案对比                                        │    │
│  │ - Linus审查清单检查                                        │    │
│  │                                                            │    │
│  │ 【产出物】                                                 │    │
│  │ - 数据结构定义 (interface)                                 │    │
│  │ - 方案对比表                                               │    │
│  │ - 架构设计文档                                             │    │
│  └────────────────────────────────────────────────────────────┘    │
│                              ↓                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ STEP 3: 寸止 - 设计确认 [DESIGN_FREEZE]                    │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │                                                            │    │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │    │
│  │ 📋 [DESIGN_FREEZE] 架构设计完成                           │    │
│  │                                                            │    │
│  │ ## 数据结构                                                │    │
│  │ [Interface 定义]                                           │    │
│  │                                                            │    │
│  │ ## 方案对比                                                │    │
│  │ | 维度 | 方案A | 方案B |                                  │    │
│  │                                                            │    │
│  │ ## 推荐                                                    │    │
│  │ 方案A，理由...                                             │    │
│  │                                                            │    │
│  │ 请选择: A / B / 讨论                                       │    │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │    │
│  │                                                            │    │
│  │ 【产出物】                                                 │    │
│  │ - 用户选择记录                                             │    │
│  │ - decisions.md 更新                                        │    │
│  └────────────────────────────────────────────────────────────┘    │
│                              ↓                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ STEP 4: 分阶段任务规划 (PLAN)                              │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │                                                            │    │
│  │ 4.1 Phase分解                                              │    │
│  │                                                            │    │
│  │     ## Phase 1: 基础架构                                   │    │
│  │     - [ ] T-001: 项目初始化                                │    │
│  │     - [ ] T-002: 数据库设计                                │    │
│  │                                                            │    │
│  │     ## Phase 2: 核心功能                                   │    │
│  │     - [ ] T-003: 核心业务逻辑                              │    │
│  │     - [ ] T-004: API接口                                   │    │
│  │                                                            │    │
│  │     ## Phase 3: 用户界面                                   │    │
│  │     - [ ] T-005: 页面组件                                  │    │
│  │     - [ ] T-006: 交互流程                                  │    │
│  │                                                            │    │
│  │ 4.2 更新 kanban.md (所有任务→TODO栏)                      │    │
│  │                                                            │    │
│  │ 【产出物】                                                 │    │
│  │ - 分阶段TODO列表                                           │    │
│  │ - kanban.md                                                │    │
│  │ - active_context.md                                        │    │
│  └────────────────────────────────────────────────────────────┘    │
│                              ↓                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ STEP 5: 寸止 - 计划确认 [PLAN_READY]                       │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │ [类似 Path B，但包含 Phase 信息]                           │    │
│  └────────────────────────────────────────────────────────────┘    │
│                              ↓                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ STEP 6: 分阶段执行 (EXECUTE LOOP)                          │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │                                                            │    │
│  │ FOR EACH phase IN phases:                                  │    │
│  │                                                            │    │
│  │   6.1 执行 Phase 内所有 TODO                               │    │
│  │       [同 Path B STEP 4]                                   │    │
│  │                                                            │    │
│  │   6.2 Phase 核对                                           │    │
│  │                                                            │    │
│  │   6.3 寸止 [PHASE_DONE]                                    │    │
│  │                                                            │    │
│  │       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │    │
│  │       📋 [PHASE_DONE] Phase X 完成                        │    │
│  │                                                            │    │
│  │       ## Phase X 核对                                      │    │
│  │       - [x] T-00X ✅                                       │    │
│  │       - [x] T-00Y ✅                                       │    │
│  │                                                            │    │
│  │       ## 整体进度                                          │    │
│  │       ████████░░░░░░░░░░░░ 40% (2/5 Phases)               │    │
│  │                                                            │    │
│  │       请选择: 继续 / 暂停 / 问题                           │    │
│  │       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │    │
│  │                                                            │    │
│  │ END FOR                                                    │    │
│  │                                                            │    │
│  │ 【产出物】                                                 │    │
│  │ - 每个Phase的代码文件                                      │    │
│  │ - 每个Phase的核对报告                                      │    │
│  │ - 持续更新的kanban.md                                      │    │
│  └────────────────────────────────────────────────────────────┘    │
│                              ↓                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ STEP 7: 全量核对 + 最终寸止 [TASK_DONE]                    │    │
│  ├────────────────────────────────────────────────────────────┤    │
│  │                                                            │    │
│  │ 7.1 生成全量核对报告                                       │    │
│  │                                                            │    │
│  │     ## 全量 TODO 核对                                      │    │
│  │                                                            │    │
│  │     ### Phase 1: 基础架构 ✅                               │    │
│  │     - [x] T-001 ✅ | - [x] T-002 ✅                        │    │
│  │                                                            │    │
│  │     ### Phase 2: 核心功能 ✅                               │    │
│  │     - [x] T-003 ✅ | - [x] T-004 ✅                        │    │
│  │                                                            │    │
│  │     ### Phase 3: 用户界面 ✅                               │    │
│  │     - [x] T-005 ✅ | - [x] T-006 ✅                        │    │
│  │                                                            │    │
│  │     ## 统计                                                │    │
│  │     - 总任务: 6/6 (100%)                                   │    │
│  │     - 总用时: 8h (预估: 10h)                               │    │
│  │                                                            │    │
│  │ 7.2 调用寸止 [TASK_DONE]                                   │    │
│  │                                                            │    │
│  │ 【产出物】                                                 │    │
│  │ - 全量核对报告                                             │    │
│  │ - 归档的工作流状态                                         │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 📋 产出物清单

### 每个路径必须产出

| 产出物 | Path A | Path B | Path C |
|:---|:---|:---|:---|
| session.lock | ✅ | ✅ | ✅ |
| TODO列表 | ✅ | ✅ | ✅ |
| kanban.md更新 | ✅ | ✅ | ✅ |
| active_context.md | ✅ | ✅ | ✅ |
| TODO核对报告 | ✅ | ✅ | ✅ |
| 寸止确认记录 | ✅ | ✅ | ✅ |
| workflow_state.json | - | ✅ | ✅ |
| 设计文档 | - | - | ✅ |
| Phase核对报告 | - | - | ✅ |

---

**版本**: v7.5 | **原则**: 强制TODO + kanban三态 + 寸止确认
