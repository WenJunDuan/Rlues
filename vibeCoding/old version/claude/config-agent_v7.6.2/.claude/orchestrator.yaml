# VibeCoding Kernel v7.6.2 - Orchestrator Configuration

version: "7.6.2"

# AI 引擎配置
engines:
  primary: claude
  available:
    - name: claude
      model: claude-sonnet-4-20250514
      strengths: [reasoning, coding, architecture]
      skill_path: null  # 内置
    - name: codex
      model: codex-latest
      strengths: [code-generation, refactoring]
      skill_path: .claude/skills/codex/SKILL.md
    - name: gemini
      model: gemini-2.0-flash
      strengths: [long-context, multimodal]
      skill_path: .claude/skills/gemini/SKILL.md

# 路径配置
paths:
  A:
    name: "快速修复"
    condition: "单文件 & <30行"
    phases: [R, P, E, R2]
    cunzhi_points: [TASK_DONE]
  B:
    name: "计划开发"
    condition: "2-10文件"
    phases: [R, I, P, E, R2]
    cunzhi_points: [PLAN_READY, TASK_DONE]
  C:
    name: "系统开发"
    condition: ">10文件或跨模块"
    phases: [R, I, P, E, R2]  # E-R2 循环多次
    cunzhi_points: [PLAN_READY, DESIGN_FREEZE, PHASE_DONE, TASK_DONE]

# Skills 配置
skills:
  # RIPER 核心技能
  riper:
    path: .claude/skills/riper/SKILL.md
    sub_skills:
      research: .claude/skills/riper/research.md
      innovate: .claude/skills/riper/innovate.md
      plan: .claude/skills/riper/plan.md
      execute: .claude/skills/riper/execute.md
      review: .claude/skills/riper/review.md
  
  # 系统技能
  cunzhi:
    path: .claude/skills/cunzhi/SKILL.md
  memory:
    path: .claude/skills/memory/SKILL.md
  code-quality:
    path: .claude/skills/code-quality/SKILL.md
  multi-ai:
    path: .claude/skills/multi-ai/SKILL.md
  
  # 外部技能
  codex:
    path: .claude/skills/codex/SKILL.md
    placeholder: true
  gemini:
    path: .claude/skills/gemini/SKILL.md
    placeholder: true
  sou:
    path: .claude/skills/sou/SKILL.md
  thinking:
    path: .claude/skills/thinking/SKILL.md

# 寸止配置
cunzhi:
  skill_path: .claude/skills/cunzhi/SKILL.md
  tool_priority:
    - cunzhi_mcp        # 优先: cunzhi MCP
    - mcp_feedback      # 降级: mcp-feedback-enhanced
    - text_output       # 最后: 文字输出（不推荐）
  tokens:
    - PLAN_READY
    - DESIGN_FREEZE
    - PHASE_DONE
    - TASK_DONE
    - VERIFICATION_FAILED
    - CLARIFY

# MCP 工具集成
mcp_tools:
  required:
    - name: memory
      purpose: "知识持久化"
      fallback: ".ai_state/knowledge.md"
    - name: sequential-thinking
      purpose: "深度推理"
      fallback: "skills/thinking/SKILL.md"
  recommended:
    - name: sou
      purpose: "语义搜索"
      fallback: "grep/ripgrep"
    - name: context7
      purpose: "需求分析"
      fallback: "手动分析"
    - name: playwright
      purpose: "浏览器测试"
      fallback: "手动测试"
    - name: mcp-shrimp-task-manager
      purpose: "任务管理"
      fallback: "TODO.md"

# 状态文件配置
state:
  directory: ".ai_state"
  files:
    - session.lock      # 会话锁
    - active_context.md # 当前上下文
    - TODO.md           # 任务列表
    - kanban.md         # 看板状态
    - errors.md         # 错误记录
    - knowledge.md      # 本地知识（Memory MCP 降级）
    - handoff.md        # AI 交接文档

# 钩子配置
hooks:
  enabled: true
  path: .claude/hooks/hooks.md
  triggers:
    - onSessionStart
    - beforeTask
    - afterTask
    - onError
    - onUserCorrection
    - onComplete
    - afterComplete

# 多AI协调
multi_ai:
  enabled: true
  skill_path: .claude/skills/multi-ai/SKILL.md
  coordination_file: .ai_state/handoff.md
  state_sync: .ai_state/
