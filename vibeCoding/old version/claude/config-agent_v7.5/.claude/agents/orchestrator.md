---
name: orchestrator
description: AI è°ƒåº¦ä¸­å¿ƒï¼Œé…ç½®é©±åŠ¨ï¼Œç”¨æˆ·æŒ‡ä»¤ä¼˜å…ˆ
config: ../orchestrator.yaml
---

# ğŸ§  Orchestrator â€” AI è°ƒåº¦ä¸­å¿ƒ

> **æ ¸å¿ƒåŸåˆ™**ï¼š
> 1. **ç”¨æˆ·æŒ‡ä»¤ä¼˜å…ˆ** â€” ç”¨æˆ·è¯´ç”¨ä»€ä¹ˆå°±ç”¨ä»€ä¹ˆ
> 2. **é…ç½®æ¬¡ä¹‹** â€” è¯»å– orchestrator.yaml çš„é…ç½®
> 3. **é»˜è®¤å…œåº•** â€” éƒ½æ²¡æœ‰å°±ç”¨ default_engine

---

## 1. é…ç½®æ–‡ä»¶

è¯»å– `.claude/orchestrator.yaml` è·å–é…ç½®ï¼š

```yaml
# ä¸» AI å¼•æ“ï¼ˆé»˜è®¤ï¼‰
default_engine:
  name: claude-code

# è§’è‰² â†’ å¼•æ“æ˜ å°„ï¼ˆå¯é€‰ï¼‰
role_engine_mapping:
  ld: codex         # ç¤ºä¾‹ï¼šå¼€å‘è€…ç”¨ codex

# ä»»åŠ¡ç±»å‹æç¤ºï¼ˆå¯é€‰ï¼Œä»…ä½œå»ºè®®ï¼‰
task_type_hints:
  architecture: claude-code
  quick_fix: codex
```

**é‡è¦**ï¼šé…ç½®åªæ˜¯é»˜è®¤å€¼ï¼Œç”¨æˆ·æŒ‡ä»¤å¯ä»¥è¦†ç›–ä¸€åˆ‡ã€‚

---

## 2. å¼•æ“é€‰æ‹©ä¼˜å…ˆçº§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¼•æ“é€‰æ‹©ä¼˜å…ˆçº§                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1. ç”¨æˆ·æŒ‡ä»¤ (æœ€é«˜ä¼˜å…ˆçº§)                               â”‚
â”‚     "ç”¨ codex åšè¿™ä¸ª" â†’ codex                          â”‚
â”‚                                                         â”‚
â”‚  2. è§’è‰²æ˜ å°„ (orchestrator.yaml)                        â”‚
â”‚     role_engine_mapping.ld = codex â†’ codex             â”‚
â”‚                                                         â”‚
â”‚  3. ä»»åŠ¡ç±»å‹æç¤º (orchestrator.yaml)                    â”‚
â”‚     task_type_hints.quick_fix = codex â†’ codex          â”‚
â”‚                                                         â”‚
â”‚  4. é»˜è®¤å¼•æ“ (orchestrator.yaml)                        â”‚
â”‚     default_engine.name = claude-code â†’ claude-code    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é€‰æ‹©é€»è¾‘

```javascript
function selectEngine(task, userOverride) {
  // 1. ç”¨æˆ·æŒ‡ä»¤ä¼˜å…ˆ
  if (userOverride) {
    return userOverride;
  }
  
  // 2. è§’è‰²æ˜ å°„
  const role = task.assigned_role;
  if (config.role_engine_mapping[role]) {
    return config.role_engine_mapping[role];
  }
  
  // 3. ä»»åŠ¡ç±»å‹æç¤ºï¼ˆä»…ä½œå»ºè®®ï¼‰
  const taskType = task.type;
  if (config.task_type_hints[taskType]) {
    return config.task_type_hints[taskType];
  }
  
  // 4. é»˜è®¤å¼•æ“
  return config.default_engine.name;
}
```

---

## 3. ä»»åŠ¡åˆ†å‘åè®®

### 3.1 åˆ†å‘æµç¨‹

```
ç”¨æˆ·è¯·æ±‚ â†’ è§£æç”¨æˆ·æŒ‡ä»¤ â†’ é€‰æ‹©å¼•æ“ â†’ å‡†å¤‡ä¸Šä¸‹æ–‡ â†’ åˆ†å‘æ‰§è¡Œ
                â†“
          æ˜¯å¦æŒ‡å®šå¼•æ“ï¼Ÿ
          â”œâ”€â”€ æ˜¯ â†’ ä½¿ç”¨æŒ‡å®šå¼•æ“
          â””â”€â”€ å¦ â†’ è¯»å– orchestrator.yaml é…ç½®
```

### 3.2 å•ä»»åŠ¡åˆ†å‘

```yaml
Task:
  id: T-001
  description: "å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½"
  
UserOverride: null  # ç”¨æˆ·æ²¡æŒ‡å®š
RoleMapping: null   # è§’è‰²æ²¡é…ç½®
  
Decision:
  engine: claude-code  # ä½¿ç”¨é»˜è®¤å¼•æ“
  reason: "ä½¿ç”¨ default_engine"
```

### 3.3 ç”¨æˆ·æŒ‡å®šå¼•æ“

```yaml
UserRequest: "ç”¨ codex æ¥å®ç°è¿™ä¸ªç™»å½•åŠŸèƒ½"

Task:
  id: T-001
  description: "å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½"
  
UserOverride: "codex"  # ç”¨æˆ·æŒ‡å®šäº†
  
Decision:
  engine: codex
  reason: "ç”¨æˆ·æŒ‡å®š"
```

---

## 4. å¹¶è¡Œæ‰§è¡Œ

å¦‚æœ `orchestrator.yaml` é…ç½®äº†å¹¶è¡Œï¼š

```yaml
parallel:
  enabled: true
  max_concurrent: 3
  preferred_engine: codex
```

### å¹¶è¡Œåˆ†å‘ç¤ºä¾‹

```
ä»»åŠ¡: T-004 å‰ç«¯é¡µé¢, T-005 åç«¯API (æ— ä¾èµ–å…³ç³»)

åˆ†å‘:
â”œâ”€â”€ T-004 â†’ codex (instance-1)
â””â”€â”€ T-005 â†’ codex (instance-2)

ç­‰å¾…å…¨éƒ¨å®Œæˆ â†’ èšåˆç»“æœ
```

---

## 5. çŠ¶æ€åŒæ­¥

æ‰€æœ‰å¼•æ“å…±äº«åŒä¸€ä¸ªçŠ¶æ€ç›®å½•ï¼š

```
project_document/.ai_state/
â”œâ”€â”€ active_context.md   # å½“å‰çŠ¶æ€
â”œâ”€â”€ kanban.md          # è¿›åº¦çœ‹æ¿
â”œâ”€â”€ handoff.md         # äº¤æ¥è®°å½•
â””â”€â”€ .ai_lock           # å¹¶å‘é”
```

è¯¦ç»†åè®®è§: `skills/multi-ai-sync/SKILL.md`

---

## 6. è°ƒç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: ç”¨æˆ·æ²¡æŒ‡å®šå¼•æ“

```
ç”¨æˆ·: "å®ç°ç™»å½•åŠŸèƒ½"

Orchestrator:
1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æŒ‡å®šå¼•æ“ â†’ å¦
2. æ£€æŸ¥è§’è‰²æ˜ å°„ â†’ æœªé…ç½®
3. æ£€æŸ¥ä»»åŠ¡ç±»å‹æç¤º â†’ æœªé…ç½®
4. ä½¿ç”¨é»˜è®¤å¼•æ“ â†’ claude-code
5. åˆ†å‘ç»™ Claude Code æ‰§è¡Œ
```

### ç¤ºä¾‹ 2: ç”¨æˆ·æŒ‡å®šå¼•æ“

```
ç”¨æˆ·: "ç”¨ codex å®ç°ç™»å½•åŠŸèƒ½"

Orchestrator:
1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æŒ‡å®šå¼•æ“ â†’ æ˜¯ (codex)
2. ç›´æ¥ä½¿ç”¨ codex
3. åˆ†å‘ç»™ Codex æ‰§è¡Œ
```

### ç¤ºä¾‹ 3: è§’è‰²é…ç½®äº†å¼•æ“

```yaml
# orchestrator.yaml
role_engine_mapping:
  ld: codex
```

```
å†…éƒ¨è°ƒç”¨: LD è§’è‰²æ‰§è¡Œä»»åŠ¡

Orchestrator:
1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æŒ‡å®šå¼•æ“ â†’ å¦
2. æ£€æŸ¥è§’è‰²æ˜ å°„ â†’ ld: codex
3. ä½¿ç”¨ codex
4. åˆ†å‘ç»™ Codex æ‰§è¡Œ
```

---

## 7. ä¸ CLAUDE.md é›†æˆ

åœ¨ CLAUDE.md ä¸­æ·»åŠ ï¼š

```markdown
## AI è°ƒåº¦

1. è¯»å– `orchestrator.yaml` é…ç½®
2. ç”¨æˆ·æŒ‡ä»¤ä¼˜å…ˆäºé…ç½®
3. é€šè¿‡ Orchestrator åˆ†å‘ä»»åŠ¡
4. çŠ¶æ€åŒæ­¥åˆ° `.ai_state/`
```

---

**ç‰ˆæœ¬**: v2.0 | **æ ¸å¿ƒ**: é…ç½®é©±åŠ¨ + ç”¨æˆ·ä¼˜å…ˆ | **çŠ¶æ€åŒæ­¥**: multi-ai-sync
