{
  "permissions": {
    "allow": [
      "Read",
      "Write",
      "Edit",
      "MultiEdit",
      "Task",
      "WebSearch",
      "WebFetch",
      "Bash(node *)",
      "Bash(npm test)",
      "Bash(npm run *)",
      "Bash(npm install *)",
      "Bash(npx tsc *)",
      "Bash(npx eslint *)",
      "Bash(npx prettier *)",
      "Bash(npx playwright *)",
      "Bash(npx ctx7 resolve *)",
      "Bash(git *)",
      "Bash(mkdir *)",
      "Bash(cp *)",
      "Bash(mv *)",
      "Bash(cat *)",
      "Bash(ls *)",
      "Bash(wc *)",
      "Bash(grep *)",
      "Bash(head *)",
      "Bash(tail *)",
      "Bash(find *)",
      "Bash(sort *)",
      "Bash(sed *)",
      "mcp__cunzhi__*",
      "mcp__augment-context-engine__*",
      "mcp__mcp-deepwiki__*"
    ],
    "deny": [
      "Bash(rm -rf /)",
      "Bash(sudo *)",
      "Bash(chmod 777 *)"
    ]
  },
  "plugins": {
    "enabled": [
      "code-review",
      "commit-commands",
      "feature-dev",
      "frontend-design",
      "hookify",
      "plugin-dev",
      "pr-review-toolkit",
      "security-guidance",
      "superpowers@superpowers-marketplace"
    ],
    "marketplaces": [
      {
        "name": "claude-official",
        "url": "registry:claude-plugins-official"
      },
      {
        "name": "claude-community",
        "url": "registry:claude-plugins-community"
      },
      {
        "name": "claude-local",
        "url": "local:.claude/plugins"
      },
      {
        "name": "superpowers-marketplace",
        "url": "github:obra/superpowers-marketplace"
      }
    ]
  },
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/session-start.cjs"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/delivery-gate.cjs",
            "timeout": 120
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit|MultiEdit",
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/post-edit.cjs",
            "timeout": 30
          }
        ]
      },
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"const d=require('fs');const f=JSON.parse(require('fs').readFileSync('/dev/stdin','utf8'));const p=f.tool_input?.file_path||'';if(/\\.tsx?$/.test(p)){const r=require('child_process').spawnSync('npx',['tsc','--noEmit'],{timeout:15000});if(r.status!==0){const out=(r.stderr||r.stdout||'').toString().slice(0,500);process.stdout.write(JSON.stringify({decision:'report',reason:'tsc errors: '+out}))}}\"",
            "async": true,
            "timeout": 20
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/pre-bash.cjs",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Write",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{try{const i=JSON.parse(d);const p=i.tool_input?.file_path||'';if(/\\.(md|txt)$/.test(p)&&!/(README|CLAUDE|AGENTS|CONTRIBUTING|CHANGELOG|LICENSE|API|ARCHITECTURE|SECURITY|MIGRATION)\\.md$/.test(p)&&!/\\.claude\\//.test(p)&&!/\\.ai_state\\//.test(p)&&!/docs?\\//.test(p)&&!/src\\//.test(p)&&!/plans?\\//.test(p)){console.error('[Hook] BLOCKED: Unnecessary doc file: '+p);console.error('[Hook] Use README.md, docs/, or .ai_state/ for documentation');process.exit(2)}}catch{}console.log(d)})\"",
            "timeout": 5
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "子代理已完成任务。检查输出: 1) 是否完成了所有指定子任务 2) 是否有未解决的错误或 TODO 3) 是否符合 .ai_state/conventions.md 规范。通过回复 accept, 有问题回复 continue 并说明需要补充什么。"
          }
        ]
      }
    ],
    "TeammateIdle": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/teammate-idle.cjs",
            "timeout": 10
          }
        ]
      }
    ],
    "TaskCompleted": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/task-completed.cjs",
            "timeout": 60
          }
        ]
      }
    ]
  },
  "env": {
    "LANGUAGE": "zh-Hans",
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1",
    "CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC": 1,
    "API_TIMEOUT_MS": "3000000",
    "CLAUDE_CODE_SUBAGENT_MODEL": "claude-sonnet-4-6",
    "VIBECODING_VERSION": "8.6.1",
    "VIBECODING_HOOKS_DISABLED": "0"
  },
  "mcpServers": {
    "augment-context-engine": {
      "type": "stdio",
      "command": "augment-context-engine"
    },
    "cunzhi": {
      "type": "stdio",
      "command": "cunzhi"
    },
    "mcp-deepwiki": {
      "type": "stdio",
      "command": "npx",
      "args": [
        "-y",
        "mcp-deepwiki@latest"
      ]
    }
  }
}